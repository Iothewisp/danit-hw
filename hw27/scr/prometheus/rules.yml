groups:
- name: system_alerts
  rules:

  # üíæ –î–∏—Å–∫ C: –º–∞—î –º–µ–Ω—à–µ 15% –≤—ñ–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è
  - alert: LowDiskSpace
    expr: (windows_logical_disk_free_bytes{volume="C:"} / windows_logical_disk_size_bytes{volume="C:"}) * 100 < 15
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "üíæ –î–∏—Å–∫ C: –º–∞—î –º–µ–Ω—à–µ 15% –≤—ñ–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è"

  # üî• CPU –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –±—ñ–ª—å—à–µ –Ω—ñ–∂ –Ω–∞ 80%
  - alert: HighCPUUsage
    expr: 100 - (avg by (instance) (rate(windows_cpu_time_total{mode="idle"}[5m])) * 100) > 80
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "üî• CPU –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –±—ñ–ª—å—à–µ –Ω—ñ–∂ –Ω–∞ 80%"

  # üî¥ –û–¥–∏–Ω —ñ–∑ —Ç–∞—Ä–≥–µ—Ç—ñ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
  - alert: TargetDown
    expr: up == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "üî¥ –û–¥–∏–Ω —ñ–∑ —Ç–∞—Ä–≥–µ—Ç—ñ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π"

  # üß† RAM usage > 90%
  - alert: HighMemoryUsage
    expr: (1 - (windows_memory_available_bytes / windows_memory_total_bytes)) * 100 > 90
    for: 1m
    labels:
      severity: warning
    annotations:
      summary: "üß† –ü–∞–º'—è—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –±—ñ–ª—å—à–µ –Ω—ñ–∂ –Ω–∞ 90%"

  # üê¢ CPU Queue Length > 5
  - alert: HighCPUQueue
    expr: windows_system_processor_queue_length > 5
    for: 30s
    labels:
      severity: warning
    annotations:
      summary: "üê¢ –ß–µ—Ä–≥–∞ CPU –ø–µ—Ä–µ–≤–∏—â—É—î 5 ‚Äî –º–æ–∂–ª–∏–≤–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"

  # üìâ Network In < 1KB/s (—Å–∏–º—É–ª—è—Ü—ñ—è –ø–∞–¥—ñ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É)
  - alert: LowNetworkIn
    expr: rate(windows_net_bytes_received_total[1m]) < 1024
    for: 1m
    labels:
      severity: info
    annotations:
      summary: "üìâ –í—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –Ω–∏–∂—á–µ 1KB/s"

  # üì§ Network Out < 1KB/s
  - alert: LowNetworkOut
    expr: rate(windows_net_bytes_sent_total[1m]) < 1024
    for: 1m
    labels:
      severity: info
    annotations:
      summary: "üì§ –í–∏—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –Ω–∏–∂—á–µ 1KB/s"

  # üïí –í–∏—Å–æ–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ IO
  - alert: HighDiskIO
    expr: rate(windows_logical_disk_write_bytes_total[1m]) > 10000000
    for: 1m
    labels:
      severity: warning
    annotations:
      summary: "üïí –í–∏—Å–æ–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –¥–∏—Å–∫ (–∑–∞–ø–∏—Å >10MB/s)"

  # üß™ –¢–µ—Å—Ç–æ–≤–∏–π –∞–ª–µ—Ä—Ç ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
  - alert: AlwaysFires
    expr: vector(1)
    for: 10s
    labels:
      severity: test
    annotations:
      summary: "üß™ –¢–µ—Å—Ç–æ–≤–∏–π –∞–ª–µ—Ä—Ç ‚Äî –∑–∞–≤–∂–¥–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î"
